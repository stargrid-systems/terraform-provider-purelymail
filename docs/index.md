---
page_title: "Provider: Purelymail"
description: |-
  Terraform provider for managing Purelymail email resources
---

# Purelymail Provider

The Purelymail provider enables Terraform to manage [Purelymail](https://purelymail.com/) email service resources including users, domains, routing rules, and app passwords.

## Example Usage

```terraform
# Configure the provider
provider "purelymail" {
  api_token = var.purelymail_api_token
}

# Create a domain
resource "purelymail_domain" "example" {
  domain_name = "example.com"
}

# Create a user with 2FA enabled
resource "purelymail_user" "alice" {
  user_name                         = "alice@example.com"
  password_wo                       = var.alice_password
  enable_search_indexing            = true
  require_two_factor_authentication = true

  # Password reset methods (required for 2FA)
  password_reset_methods = [
    {
      type            = "email"
      target          = "alice@recovery.example.com"
      description     = "Primary recovery email"
      allow_mfa_reset = true
    }
  ]
}

# Create a routing rule
resource "purelymail_routing_rule" "catch_all" {
  domain_name      = purelymail_domain.example.domain_name
  match_user       = "*"
  hostname         = purelymail_domain.example.domain_name
  target_addresses = ["alice@example.com"]
}

# Generate an app password
resource "purelymail_app_password" "mobile" {
  user_name   = purelymail_user.alice.user_name
  description = "Mobile email client"
}
```

## Authentication

The provider requires a Purelymail API token for authentication. You can obtain this from your Purelymail account settings.

### Setting the API Token

The API token can be provided in three ways:

1. **Provider configuration** (not recommended for production):
```terraform
provider "purelymail" {
  api_token = "your-api-token"
}
```

2. **Environment variable** (recommended):
```sh
export PURELYMAIL_API_TOKEN="your-api-token"
terraform apply
```

3. **Terraform variables**:
```terraform
variable "purelymail_api_token" {
  type      = string
  sensitive = true
}

provider "purelymail" {
  api_token = var.purelymail_api_token
}
```

## Available Resources

- **[purelymail_user](resources/user)**: Manage user accounts with 2FA and password reset methods
- **[purelymail_domain](resources/domain)**: Add and configure email domains
- **[purelymail_routing_rule](resources/routing_rule)**: Configure email routing and forwarding
- **[purelymail_app_password](resources/app_password)**: Generate application-specific passwords
- **[purelymail_password_reset_method](resources/password_reset_method)**: Standalone password reset method management

## Available Data Sources

- **[purelymail_ownership_proof](data-sources/ownership_proof)**: Get domain ownership verification codes

## Available Ephemeral Resources

- **[purelymail_app_password](ephemeral-resources/app_password)**: Generate temporary app passwords

## Features

### Automatic 2FA Workflow

The provider handles the complex ordering requirements for enabling two-factor authentication automatically. Simply configure the user resource with `require_two_factor_authentication = true` and include at least one `password_reset_methods` entry:

```terraform
resource "purelymail_user" "secure_user" {
  user_name                         = "secure"
  password_wo                       = "strong-password"
  require_two_factor_authentication = true

  password_reset_methods = [
    {
      type   = "email"
      target = "backup@example.com"
    }
  ]
}
```

The provider will:
1. Create the user account
2. Add the password reset methods
3. Enable 2FA requirement

All in a single `terraform apply` operation!

### Flexible Configuration

Password reset methods can be managed in two ways:

1. **Nested** (recommended): As part of the user resource
2. **Standalone**: Using separate `purelymail_password_reset_method` resources

Choose the approach that best fits your infrastructure-as-code workflow.

### Import Support

All resources support Terraform import for managing existing Purelymail resources:

```sh
# Import a user
terraform import purelymail_user.alice alice

# Import a domain
terraform import purelymail_domain.example example.com

# Import a password reset method
terraform import purelymail_password_reset_method.recovery "alice:alice@recovery.com"
```

<!-- schema generated by tfplugindocs -->
## Schema

### Optional

- `api_token` (String, Sensitive) API authentication token. Required for API access.
- `endpoint` (String) API endpoint URL. Defaults to https://purelymail.com

